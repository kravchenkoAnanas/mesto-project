(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{OP:()=>I,Rm:()=>M,xZ:()=>C,Hw:()=>x,xD:()=>g,Hj:()=>P,N_:()=>T,PI:()=>H,JY:()=>J,Gs:()=>S,$g:()=>L,hP:()=>k,uN:()=>E,Y7:()=>U,de:()=>O,w6:()=>w,M2:()=>h,WU:()=>v,A5:()=>_,xS:()=>i});var t={baseUrl:"https://nomoreparties.co/v1/plus-cohort-18",headers:{authorization:"90a3b86c-0f37-47cc-a67e-3897ae76ba03","Content-Type":"application/json"}};function n(e,n,o,r,u,a){var s,l=function(e,n,o,r,u,a){var s=I.cloneNode(!0),l=s.querySelector(".element__mask-group"),d=s.querySelector(".element__title"),p=s.querySelector(".element__like"),f=s.querySelector(".element__count"),m=s.querySelector(".element__trash");return d.textContent=n,f.textContent=r,l.setAttribute("src",o),l.addEventListener("click",(function(){O.textContent=n,w.setAttribute("src",o),w.setAttribute("alt",n),c(U)})),a&&p.classList.add("element__like_active"),p.addEventListener("click",(function(n){n.target.classList.contains("element__like_active")?(n.target.classList.remove("element__like_active"),f.textContent=parseInt(f.textContent)-1,function(e){fetch("".concat(t.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(e)):(n.target.classList.add("element__like_active"),f.textContent=parseInt(f.textContent)+1,function(e){fetch("".concat(t.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(e))})),i===u?m.addEventListener("click",(function(n){n.target.closest(".element").remove(),function(e){fetch("".concat(t.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(e)})):m.remove(),s}(e,n,o,r,u,a);s=l,M.prepend(s)}function o(e,t){e?t.setAttribute("value",t.value+"..."):t.setAttribute("value",t.value.replace("...",""))}function r(e){"Escape"===e.key&&u(document.querySelector(".popup_opened"))}function c(e){e.classList.contains("popup_opened")||(e.classList.add("popup_opened"),document.addEventListener("keydown",r))}function u(e){e.classList.contains("popup_opened")&&(e.classList.remove("popup_opened"),document.removeEventListener("keydown",r))}var i,a,s=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,t.classList.remove(n.inactiveButtonClass)):(t.disabled=!0,t.classList.add(n.inactiveButtonClass))},l=document.querySelector(".content"),d=Array.from(document.querySelectorAll(".popup")),p=l.querySelector(".profile__info"),f=p.querySelector(".profile__edit-button"),m=l.querySelector(".profile__add-button"),_=p.querySelector(".profile__title"),v=p.querySelector(".profile__subtitle"),y=l.querySelector(".profile__avatar"),h=l.querySelector(".profile__avatar-img"),S=document.querySelector(".edit-popup"),b=S.querySelector(".popup__content"),q=S.querySelector(".popup__close"),k=b.querySelector("#name-input"),L=b.querySelector("#info-input"),E=b.querySelector(".popup__submit-button"),C=document.querySelector(".add-popup"),j=C.querySelector(".popup__content"),A=C.querySelector(".popup__close"),g=C.querySelector("#name-input"),x=C.querySelector("#link-input"),P=C.querySelector(".popup__submit-button"),U=document.querySelector(".img-popup"),w=U.querySelector(".popup__full"),O=U.querySelector(".popup__description"),D=U.querySelector(".popup__close"),T=document.querySelector(".avatar-popup"),N=T.querySelector(".popup__content"),B=T.querySelector(".popup__close"),H=T.querySelector("#link-input"),J=T.querySelector(".popup__submit-button"),M=l.querySelector(".elements"),I=document.querySelector("#element").content;f.addEventListener("click",(function(){k.value=_.textContent,L.value=v.textContent,c(S)})),q.addEventListener("click",(function(){u(S)})),b.addEventListener("submit",(function(e){e.preventDefault();var n=k.value,r=L.value;_.textContent=n,v.textContent=r,o(!0,E),function(e,n){return fetch("".concat(t.baseUrl,"/users/me"),{method:"PATCH",headers:t.headers,body:JSON.stringify({name:e,about:n})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(n,r).finally((function(){o(!1,E)})),u(S)})),m.addEventListener("click",(function(){c(C)})),A.addEventListener("click",(function(){u(C)})),j.addEventListener("submit",(function(e){e.preventDefault();var r=g.value,c=x.value;o(!0,P),function(e,n){return fetch("".concat(t.baseUrl,"/cards"),{method:"POST",headers:t.headers,body:JSON.stringify({name:e,link:n})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(r,c).then((function(e){n(e._id,e.name,e.link,e.likes.length,e.owner._id)})).finally((function(){o(!1,P)})),u(C),e.target.reset()})),D.addEventListener("click",(function(){u(U)})),y.addEventListener("click",(function(){c(T)})),B.addEventListener("click",(function(){u(T)})),N.addEventListener("submit",(function(e){e.preventDefault();var n=H.value;h.setAttribute("src",n),o(!0,J),function(e){return fetch("".concat(t.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:t.headers,body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(n).finally((function(){o(!1,J)})),u(T)})),a={formSelector:".popup__content",fieldsetSelector:".popup__input-items",inputSelector:".popup__input-item",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_inactive",errorClass:"popup__input-item_error"},Array.from(document.querySelectorAll(a.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),Array.from(e.querySelectorAll(a.fieldsetSelector)).forEach((function(e){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);s(n,o,t),n.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?function(e,t,n){e.classList.remove(n.errorClass),t.textContent=""}(t,o,n):function(e,t,n,o){e.classList.add(o.errorClass),t.textContent=n}(t,o,t.validationMessage,n)}(e,r,t),s(n,o,t)}))}))}(e,a)}))})),window.addEventListener("mousedown",(function(e){var t=e.target;d.some((function(e){return e===t}))&&d.forEach((function(e){u(e)}))})),fetch("".concat(t.baseUrl,"/users/me"),{headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){i=e._id,_.textContent=e.name,v.textContent=e.about,h.setAttribute("src",e.avatar),h.setAttribute("alt","Аватар")})),fetch("".concat(t.baseUrl,"/cards"),{headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){e.reverse().forEach((function(e){n(e._id,e.name,e.link,e.likes.length,e.owner._id,e.likes.some((function(e){return e._id===i})))}))}))})();